import{B as j,O as ie,P as U,t as F,w as B}from"./chunk-WHMI2CMZ.js";import{d as re,f as b,g as N}from"./chunk-JNK3CWWL.js";import{h as ne,i as oe}from"./chunk-KQCFWALD.js";import{D as V,E as Q,F as O,G as S,Ga as q,Ma as K,X as z,_ as x,ba as c,ca as M,cb as P,db as ee,e as s,ea as f,ga as o,h as Y,k as w,mb as L,nb as te,p as R,q as A,sa as J,t as X,vb as k,xa as g}from"./chunk-AIMOANAG.js";var E=new f("API_AUTH_CONFIG",{factory:()=>({baseUrl:s.TEVET_API_AUTH})}),se=new f("API_AUTH_CONFIG",{factory:()=>({baseUrl:s.TEVET_API})}),y=new f("TEVET_API_AUTH_CLIENT",{factory:()=>({baseUrl:s.TEVET_API_AUTH_CLIENT})});var ae=(()=>{class t{role=g([ne.GUEST]);permissions=g(oe.PROJECT_READ);set userRole(e){this.role.set([...e])}get userRole(){return this.role()}set userPermission(e){this.permissions.set(e)}get userPermission(){return this.permissions()}static \u0275fac=function(r){return new(r||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var p=class extends Error{};p.prototype.name="InvalidTokenError";function _e(t){return decodeURIComponent(atob(t).replace(/(.)/g,(a,e)=>{let r=e.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}function ge(t){let a=t.replace(/-/g,"+").replace(/_/g,"/");switch(a.length%4){case 0:break;case 2:a+="==";break;case 3:a+="=";break;default:throw new Error("base64 string is not of the correct length")}try{return _e(a)}catch{return atob(a)}}function le(t,a){if(typeof t!="string")throw new p("Invalid token specified: must be a string");a||(a={});let e=a.header===!0?0:1,r=t.split(".")[e];if(typeof r!="string")throw new p(`Invalid token specified: missing part #${e+1}`);let i;try{i=ge(r)}catch(n){throw new p(`Invalid token specified: invalid base64 for part #${e+1} (${n.message})`)}try{return JSON.parse(i)}catch(n){throw new p(`Invalid token specified: invalid json for part #${e+1} (${n.message})`)}}var ce=(()=>{class t{decodeToken(e){return le(e)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var u=(()=>{class t{_permissionService=o(ae);_jwtDecodeService=o(ce);_accessToken=g(null);get accessToken(){return this._accessToken()}setToken(e){e&&(this._permissionService.userRole=this._jwtDecodeService.decodeToken(e).roles,this._permissionService.userPermission=this._jwtDecodeService.decodeToken(e).perms),this._accessToken.set(e)}clear(){this._accessToken.set(null)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var W=new re(()=>!1),de=(()=>{class t{tokenAuthClient=o(y);tokenAuthApi=o(E);tokenApi=o(se);http=o(b);tokenSvc=o(u);intercept(e,r){return r.handle(e).pipe(S(i=>{let n=this.tokenAuthApi.baseUrl,d=this.tokenApi.baseUrl,D=(l=>{try{return new URL(l).href}catch{try{return new URL(l,d).href}catch{return l}}})(e.url||""),G=D.startsWith(n)||D.startsWith(d),$=`${n}/v1/auth/refresh`,me=D.startsWith($),Z=e.context.get(W),I=()=>{let l=encodeURIComponent(window.location.href),_=btoa(l);return window.location.href=`${this.tokenAuthClient.baseUrl}/login?next=${_}&client=hospital`,V};return i.status===401&&me?I():i.status===403?V:i.status===401&&G&&Z?I():i.status===401&&G&&!Z?this.http.post($,{},{withCredentials:!0}).pipe(x(l=>{let _=l?.message?.access_token??null;_&&this.tokenSvc.setToken(_)}),z(()=>{let l=this.tokenSvc.accessToken,_=l?e.clone({context:e.context.set(W,!0),setHeaders:{Authorization:`Bearer ${l}`}}):e.clone({context:e.context.set(W,!0)});return r.handle(_)}),S(l=>l?.status===401?I():A(()=>l))):A(()=>i.error??i)}))}static \u0275fac=function(r){return new(r||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var he=(()=>{class t{tokenSvc=o(u);intercept(e,r){let i=this.tokenSvc.accessToken;if(!i)return r.handle(e);let n=e.clone({setHeaders:{Authorization:`Bearer ${i}`}});return r.handle(n)}static \u0275fac=function(r){return new(r||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var ct={provide:N,useClass:he,multi:!0},dt={provide:N,useClass:de,multi:!0};function wt(){let t=o(E),a=o(b),e=o(u);return X(a.post(`${t.baseUrl}/v1/auth/refresh`,{},{withCredentials:!0}).pipe(x(r=>{let i=r?.access_token??r?.token??r?.message?.access_token??null;i&&e.setToken(i)}),S(()=>(e.clear(),R(null)))))}var At=(t,a)=>{let e=o(y);if(o(u).accessToken)return!0;let n=encodeURIComponent(window.location.href),d=btoa(n);return window.location.href=`${e.baseUrl}/login?next=${d}&client=hospital`,!1};var Wt={XSmall:"(max-width: 599.98px)",Small:"(min-width: 600px) and (max-width: 959.98px)",Medium:"(min-width: 960px) and (max-width: 1279.98px)",Large:"(min-width: 1280px) and (max-width: 1919.98px)",XLarge:"(min-width: 1920px)",Handset:"(max-width: 599.98px) and (orientation: portrait), (max-width: 959.98px) and (orientation: landscape)",Tablet:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait), (min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",Web:"(min-width: 840px) and (orientation: portrait), (min-width: 1280px) and (orientation: landscape)",HandsetPortrait:"(max-width: 599.98px) and (orientation: portrait)",TabletPortrait:"(min-width: 600px) and (max-width: 839.98px) and (orientation: portrait)",WebPortrait:"(min-width: 840px) and (orientation: portrait)",HandsetLandscape:"(max-width: 959.98px) and (orientation: landscape)",TabletLandscape:"(min-width: 960px) and (max-width: 1279.98px) and (orientation: landscape)",WebLandscape:"(min-width: 1280px) and (orientation: landscape)"};function Zt(t){return t==null?"":typeof t=="string"?t:`${t}px`}function Jt(t){return t!=null&&`${t}`!="false"}var h=(function(t){return t[t.NORMAL=0]="NORMAL",t[t.NEGATED=1]="NEGATED",t[t.INVERTED=2]="INVERTED",t})(h||{}),T,m;function ue(){if(m==null){if(typeof document!="object"||!document||typeof Element!="function"||!Element)return m=!1,m;if("scrollBehavior"in document.documentElement.style)m=!0;else{let t=Element.prototype.scrollTo;t?m=!/\{\s*\[native code\]\s*\}/.test(t.toString()):m=!1}}return m}function v(){if(typeof document!="object"||!document)return h.NORMAL;if(T==null){let t=document.createElement("div"),a=t.style;t.dir="rtl",a.width="1px",a.overflow="auto",a.visibility="hidden",a.pointerEvents="none",a.position="absolute";let e=document.createElement("div"),r=e.style;r.width="2px",r.height="1px",t.appendChild(e),document.body.appendChild(t),T=h.NORMAL,t.scrollLeft===0&&(t.scrollLeft=1,T=t.scrollLeft===0?h.NEGATED:h.INVERTED),t.remove()}return T}function ir(){return typeof __karma__<"u"&&!!__karma__||typeof jasmine<"u"&&!!jasmine||typeof jest<"u"&&!!jest||typeof Mocha<"u"&&!!Mocha}var we=20,Se=(()=>{class t{_ngZone=o(k);_platform=o(F);_renderer=o(P).createRenderer(null,null);_cleanupGlobalListener;constructor(){}_scrolled=new w;_scrolledCount=0;scrollContainers=new Map;register(e){this.scrollContainers.has(e)||this.scrollContainers.set(e,e.elementScrolled().subscribe(()=>this._scrolled.next(e)))}deregister(e){let r=this.scrollContainers.get(e);r&&(r.unsubscribe(),this.scrollContainers.delete(e))}scrolled(e=we){return this._platform.isBrowser?new Y(r=>{this._cleanupGlobalListener||(this._cleanupGlobalListener=this._ngZone.runOutsideAngular(()=>this._renderer.listen("document","scroll",()=>this._scrolled.next())));let i=e>0?this._scrolled.pipe(O(e)).subscribe(r):this._scrolled.subscribe(r);return this._scrolledCount++,()=>{i.unsubscribe(),this._scrolledCount--,this._scrolledCount||(this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0)}}):R()}ngOnDestroy(){this._cleanupGlobalListener?.(),this._cleanupGlobalListener=void 0,this.scrollContainers.forEach((e,r)=>this.deregister(r)),this._scrolled.complete()}ancestorScrolled(e,r){let i=this.getAncestorScrollContainers(e);return this.scrolled(r).pipe(Q(n=>!n||i.indexOf(n)>-1))}getAncestorScrollContainers(e){let r=[];return this.scrollContainers.forEach((i,n)=>{this._scrollableContainsElement(n,e)&&r.push(n)}),r}_scrollableContainsElement(e,r){let i=B(r),n=e.getElementRef().nativeElement;do if(i==n)return!0;while(i=i.parentElement);return!1}static \u0275fac=function(r){return new(r||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})(),ai=(()=>{class t{elementRef=o(q);scrollDispatcher=o(Se);ngZone=o(k);dir=o(ie,{optional:!0});_scrollElement=this.elementRef.nativeElement;_destroyed=new w;_renderer=o(ee);_cleanupScroll;_elementScrolled=new w;constructor(){}ngOnInit(){this._cleanupScroll=this.ngZone.runOutsideAngular(()=>this._renderer.listen(this._scrollElement,"scroll",e=>this._elementScrolled.next(e))),this.scrollDispatcher.register(this)}ngOnDestroy(){this._cleanupScroll?.(),this._elementScrolled.complete(),this.scrollDispatcher.deregister(this),this._destroyed.next(),this._destroyed.complete()}elementScrolled(){return this._elementScrolled}getElementRef(){return this.elementRef}scrollTo(e){let r=this.elementRef.nativeElement,i=this.dir&&this.dir.value=="rtl";e.left==null&&(e.left=i?e.end:e.start),e.right==null&&(e.right=i?e.start:e.end),e.bottom!=null&&(e.top=r.scrollHeight-r.clientHeight-e.bottom),i&&v()!=h.NORMAL?(e.left!=null&&(e.right=r.scrollWidth-r.clientWidth-e.left),v()==h.INVERTED?e.left=e.right:v()==h.NEGATED&&(e.left=e.right?-e.right:e.right)):e.right!=null&&(e.left=r.scrollWidth-r.clientWidth-e.right),this._applyScrollToOptions(e)}_applyScrollToOptions(e){let r=this.elementRef.nativeElement;ue()?r.scrollTo(e):(e.top!=null&&(r.scrollTop=e.top),e.left!=null&&(r.scrollLeft=e.left))}measureScrollOffset(e){let r="left",i="right",n=this.elementRef.nativeElement;if(e=="top")return n.scrollTop;if(e=="bottom")return n.scrollHeight-n.clientHeight-n.scrollTop;let d=this.dir&&this.dir.value=="rtl";return e=="start"?e=d?i:r:e=="end"&&(e=d?r:i),d&&v()==h.INVERTED?e==r?n.scrollWidth-n.clientWidth-n.scrollLeft:n.scrollLeft:d&&v()==h.NEGATED?e==r?n.scrollLeft+n.scrollWidth-n.clientWidth:-n.scrollLeft:e==r?n.scrollLeft:n.scrollWidth-n.clientWidth-n.scrollLeft}static \u0275fac=function(r){return new(r||t)};static \u0275dir=te({type:t,selectors:[["","cdk-scrollable",""],["","cdkScrollable",""]]})}return t})(),Ce=20,li=(()=>{class t{_platform=o(F);_listeners;_viewportSize;_change=new w;_document=o(J);constructor(){let e=o(k),r=o(P).createRenderer(null,null);e.runOutsideAngular(()=>{if(this._platform.isBrowser){let i=n=>this._change.next(n);this._listeners=[r.listen("window","resize",i),r.listen("window","orientationchange",i)]}this.change().subscribe(()=>this._viewportSize=null)})}ngOnDestroy(){this._listeners?.forEach(e=>e()),this._change.complete()}getViewportSize(){this._viewportSize||this._updateViewportSize();let e={width:this._viewportSize.width,height:this._viewportSize.height};return this._platform.isBrowser||(this._viewportSize=null),e}getViewportRect(){let e=this.getViewportScrollPosition(),{width:r,height:i}=this.getViewportSize();return{top:e.top,left:e.left,bottom:e.top+i,right:e.left+r,height:i,width:r}}getViewportScrollPosition(){if(!this._platform.isBrowser)return{top:0,left:0};let e=this._document,r=this._getWindow(),i=e.documentElement,n=i.getBoundingClientRect(),d=-n.top||e.body.scrollTop||r.scrollY||i.scrollTop||0,H=-n.left||e.body.scrollLeft||r.scrollX||i.scrollLeft||0;return{top:d,left:H}}change(e=Ce){return e>0?this._change.pipe(O(e)):this._change}_getWindow(){return this._document.defaultView||window}_updateViewportSize(){let e=this._getWindow();this._viewportSize=this._platform.isBrowser?{width:e.innerWidth,height:e.innerHeight}:{width:0,height:0}}static \u0275fac=function(r){return new(r||t)};static \u0275prov=c({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var fe=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=L({type:t});static \u0275inj=M({})}return t})(),ci=(()=>{class t{static \u0275fac=function(r){return new(r||t)};static \u0275mod=L({type:t});static \u0275inj=M({imports:[U,fe,U,fe]})}return t})();var Re=new f("MATERIAL_ANIMATIONS");var pe=null;function xe(){return o(Re,{optional:!0})?.animationsDisabled||o(K,{optional:!0})==="NoopAnimations"?"di-disabled":(pe??=o(j).matchMedia("(prefers-reduced-motion)").matches,pe?"reduced-motion":"enabled")}function pi(){return xe()!=="enabled"}export{Zt as a,Jt as b,ue as c,ir as d,Se as e,ai as f,li as g,fe as h,ci as i,Wt as j,pi as k,ae as l,u as m,ct as n,dt as o,wt as p,At as q};
